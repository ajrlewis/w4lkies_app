# w4lkies_app

![My Package Logo](static/img/logo.png)

## About

Public repository for the https://w4lkies.com website.

## Downloading & Installing

Clone the project

```bash
git clone https://github.com/ajrlewis/w4lkies_app.git
cd w4lkies_app
```

Install with the following script:

```bash
bash scripts/install.sh
```

## Running the App

Set the following environment variables:

| Variable | Description |
| :------- | :---------- |
| DATABASE_PASSWORD | |
| DATABASE_USERNAME | |
| LOGURU_LEVEL | The logger level, see https://loguru.readthedocs.io/en/stable/api/logger.html |
| MAIL_DEFAULT_SENDER_NAME | |
| MAIL_PASSWORD | |
| MAIL_PORT | |
| MAIL_SERVER | |
| MAIL_USE_SSL | |
| MAIL_USE_TLS | |
| MAIL_USERNAME | |
| REMEMBER_COOKIE_DURATION | |
| WEBSITE_LTD_NAME | |
| WEBSITE_NAME | |
| WEBSITE_SLOGAN | |
| WEBSITE_TELEPHONE | |
| WEBISTE_ADDRESS | |
| WEBSITE_INSTAGRAM | |
| WEBSITE_NOSTR | |
| WEBSITE_URL | |

Run locally using:

```bash
bash scripts/wsgi.sh <optional host> <optional port>
```

## Deploying

Add the file you want to deploy (e.g. `git add <file to add>`) and commit it (e.g. `git commit -m "<message for commit>"`) then:

```bash
bash scripts/gandi.sh -pd
```

Get help on the usage of this script as follows:

```bash
bash scripts/gandi.sh -u
```

```
Gandi installation & development script.

Syntax: install.sh [-d|h]
options:
i     Initialize gandi and github remote repositories.
p     Push to remote repositories.
d     Deploy to gandi instance.
u     Print this help for usage.
```

## Migrations

After pushing and deploying to the remote server, SSH into the remote server and then:

```bash
cd /srv/data/web/vhosts/default/
bash scripts/migrate <optional migration message>
```

Make sure the `alembic_version` table is generated by running:

```bash
bash scripts/migrate init
```

## Reset Logs

SSH into the remote server and then:

```bash
cd /srv/data/var/log/www/
echo "" > uwsgi.log
```

## License

This package is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
